require("avante").setup({
  default_provider = "fast",

  behaviour = {
    auto_context = false,
  },

  context = {
    use_diagnostics = false,
    use_git_diff = false,
    use_lsp = false,
  },

  providers = {
    

    localprovider = {
        endpoint = "http://192.168.0.113:6767/v1",
        extra_request_body = {
            temperature = 0.2,                                     
            max_tokens = 128,                                      
            stop = { "<|assistant|>", "<|user|>", "</s>" },    
            }
        },                                                         
    
    
    -- ‚ö° ULTRA FAST ‚Äî phi-2
    fast = {
                  __inherited_from = "localprovider",
      model = "phi-2",
      system_prompt = [[
–û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.
–ü–∏—à–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
–ë–µ–∑ –ª–∏—à–Ω–∏—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.
–Ø–∑—ã–∫ –æ—Ç–≤–µ—Ç–∞: —Ä—É—Å—Å–∫–∏–π.
]],
      
    },

    -- ‚öñÔ∏è BALANCED ‚Äî phi-3
    mid = {
    __inherited_from = "localprovider",
      model = "phi-3-mini-4k-instruct",
      system_prompt = [[
–¢—ã –æ–ø—ã—Ç–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫.
–û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.
–ï—Å–ª–∏ –º–µ–Ω—è–µ—à—å –∫–æ–¥ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∏—Ñ—Ñ—ã.
–ù–µ —Ç—Ä–æ–≥–∞–π –ª–∏—à–Ω–µ–µ.

–í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
–Ø–∑—ã–∫ –æ—Ç–≤–µ—Ç–∞: —Ä—É—Å—Å–∫–∏–π.
]],
      extra_request_body = {
        temperature = 0.2,
        max_tokens = 256,
        stop = { "<|assistant|>", "<|user|>", "</s>" },
      },
    },

    -- üß† SMART ‚Äî StarCoder2
    smart = {
    __inherited_from = "localprovider",
      model = "qwen2.5-v1-7b",
      system_prompt = [[
–¢—ã —Å—Ç–∞—Ä—à–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫.
–†–∞–±–æ—Ç–∞–π –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∏ —Ç–æ—á–Ω–æ.
–ò–∑–º–µ–Ω—è–π —Ç–æ–ª—å–∫–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–æ–¥.
–ü—Ä–µ–¥–ª–∞–≥–∞–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∏—Ñ—Ñ—ã.
–ù–µ —Ç—Ä–æ–≥–∞–π –ª–∏—à–Ω–µ–µ.

–í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
–Ø–∑—ã–∫ –æ—Ç–≤–µ—Ç–∞: —Ä—É—Å—Å–∫–∏–π.
]],
      extra_request_body = {
        temperature = 0.1,
        max_tokens = 512,
        stop = { "<|assistant|>", "<|user|>", "</s>" },
      },
    },
  },
})


local function avante_with(provider, cmd)
  return function()
    -- –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –º–æ–¥–µ–ª—å
    vim.cmd("AvanteSwitchProvider " .. provider)
    -- –≤—ã–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –∫–æ–º–∞–Ω–¥—É
    vim.cmd(cmd)
  end
end



vim.keymap.set("v", "<leader>afx", avante_with("fast",  "AvanteAsk"), { desc = "Fast explain" })
vim.keymap.set("v", "<leader>amx", avante_with("mid",   "AvanteAsk"), { desc = "Mid explain" })
vim.keymap.set("v", "<leader>asx", avante_with("smart", "AvanteAsk"), { desc = "Smart explain" })

vim.keymap.set("n", "<leader>afc", avante_with("fast",  "AvanteChat"), { desc = "Fast chat" })
vim.keymap.set("n", "<leader>amc", avante_with("mid",   "AvanteChat"), { desc = "Mid chat" })
vim.keymap.set("n", "<leader>asc", avante_with("smart", "AvanteChat"), { desc = "Smart chat" })

vim.keymap.set("v", "<leader>afe", avante_with("fast",  "AvanteEdit"), { desc = "Fast edit" })
vim.keymap.set("v", "<leader>ame", avante_with("mid",   "AvanteEdit"), { desc = "Mid edit" })
vim.keymap.set("v", "<leader>ase", avante_with("smart", "AvanteEdit"), { desc = "Smart edit" })

vim.keymap.set("v", "<leader>afr", avante_with("fast",  "AvanteRefactor"), { desc = "Fast refactor" })
vim.keymap.set("v", "<leader>amr", avante_with("mid",   "AvanteRefactor"), { desc = "Mid refactor" })
vim.keymap.set("v", "<leader>asr", avante_with("smart", "AvanteRefactor"), { desc = "Smart refactor" })


vim.keymap.set("n", "<leader>as", function()
  vim.cmd("AvanteStop")
end, { desc = "Stop AI generation" })

vim.keymap.set("n", "<leader>ac", function()
  vim.cmd("AvanteClear")
end, { desc = "clear AI generation" })

vim.keymap.set("n", "<leader>at", function()
  vim.cmd("AvanteToggle")
end, { desc = "toggle avante" })


-- Undo AI change
vim.keymap.set("n", "<leader>au", "u", { desc = "Undo AI change" })
